mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi = 0.0014,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi = 0.0013,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
sex_oriented <- function(year, state_values, parameters) {
with(as.list(c(state_values, parameters)),{
#Total population
# N_M = (S_M + I_M + T_M)
# N_W = (S_W + I_W + T_W)
# N_MSM= (S_MSM + I_MSM+T_MSM)
# transmission_rate
# lambda_M = beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M)
# lambda_W = beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W)
# lambda_MSM = beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM)
# Suceptible Population
dS_M = Pi1 * (1 - tau) * psi1 + rho * S_MSM - beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M) * S_M - ( mu_d * zeta ) * S_M
dS_W = Pi2 * tau * psi2 - beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W) * S_W - mu_d * S_W
dS_MSM = zeta * S_M -  beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM) * S_MSM - (mu_d * rho) * S_MSM
#Infected Population
dI_M = beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M)* S_M - (mu_d + delta_a) * I_M
dI_W = beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W) * S_W - (mu_d + delta_a) * I_W
dI_MSM =  beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM) * S_MSM - (mu_d + delta_a) * I_MSM
#Treated Populatoio but
dT_M = delta_a * I_M - (mu_d) * T_M
dT_W = delta_a * I_W - (mu_d) * T_W
dT_MSM = delta_a * I_MSM - (mu_d) * T_MSM
return(list(c(dS_M,dS_W,dS_MSM,dI_M,dI_W,dI_MSM,dT_M,dT_W,dT_MSM)))
})
}
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0009,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
sex_oriented <- function(year, state_values, parameters) {
with(as.list(c(state_values, parameters)),{
#Total population
# N_M = (S_M + I_M + T_M)
# N_W = (S_W + I_W + T_W)
# N_MSM= (S_MSM + I_MSM+T_MSM)
# transmission_rate
# lambda_M = beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M)
# lambda_W = beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W)
# lambda_MSM = beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM)
# Suceptible Population
dS_M = Pi * (1 - tau) * psi1 + rho * S_MSM - beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M) * S_M - ( mu_d * zeta ) * S_M
dS_W = Pi * tau * psi2 - beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W) * S_W - mu_d * S_W
dS_MSM = zeta * S_M -  beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM) * S_MSM - (mu_d * rho) * S_MSM
#Infected Population
dI_M = beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M)* S_M - (mu_d + delta_a) * I_M
dI_W = beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W) * S_W - (mu_d + delta_a) * I_W
dI_MSM =  beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM) * S_MSM - (mu_d + delta_a) * I_MSM
#Treated Populatoio but
dT_M = delta_a * I_M - (mu_d) * T_M
dT_W = delta_a * I_W - (mu_d) * T_W
dT_MSM = delta_a * I_MSM - (mu_d) * T_MSM
return(list(c(dS_M,dS_W,dS_MSM,dI_M,dI_W,dI_MSM,dT_M,dT_W,dT_MSM)))
})
}
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0009,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0008,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0003,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00025,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0003,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0004,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0006,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0008,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.0009,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.001,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00097,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00097,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.2,omega_2=0.2,kappa_1=0.6222,kappa_2=0.44,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.1,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.1)
ode(init, Years, sex_oriented,parameter)
ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.1)
Es
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0.1,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.3, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.0004,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.007,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.01,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.01,beta_2=0.0008,beta_3=0.138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.01,beta_2=0.0008,beta_3=0.0138,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.01,beta_2=0.0008,beta_3=0.02,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.01,beta_2=0.0008,beta_3=0.03,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.004,beta_2=0.0008,beta_3=0.03,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.004,beta_2=0.0008,beta_3=0.04,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.004,beta_2=0.0008,beta_3=0.037,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.004,beta_2=0.0008,beta_3=0.0364,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.004,beta_2=0.0008,beta_3=0.0367,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.004,beta_2=0.0008,beta_3=0.0368,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
parameter <- c(beta_1=0.004,beta_2=0.0008,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[9]
R
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.001,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.008,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.01,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.016,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.018,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.021,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.022,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.2,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.022,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.1,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.022,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.01,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.02,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.023,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.024,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.025,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.0247,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
parameter <- c(beta_1=0.004,beta_2=0.0248,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
# Es <-ode(init, Years, sex_oriented,parameter)[,5]+ ode(init, Years, sex_oriented,parameter)[7]+ ode(init, Years, sex_oriented,parameter)[,8]+ ode(init, Years, sex_oriented,parameter)[,10]
# Es
R <-ode(init, Years, sex_oriented,parameter)[,6]+ ode(init, Years, sex_oriented,parameter)[,9]
R
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.004,beta_2=0.0247,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
require(mkin)
require(GenSA)
require(deSolve)
options(digits = 9)
set.seed(1234)
str(FOCUS_2006_D)
df<- function(t, y, parameters) {
d_parent<- -parameters["k_parent_sink"]*y["parent"]-parameters["k_parent_m1"]*y ["parent"]
d_m1 <- parameters["k_parent_m1"]*y["parent"]-parameters ["k_m1_sink"]* y ["m1"]
return(list(c(d_parent, d_m1)))
}
fn<- function(x,names_x = c("parent_0", "k_parent_sink", "k_parent_m1","k_m1_sink"),
names_y = c("parent", "m1"),
names_parameters = c("k_parent_sink", "k_parent_m1","k_m1_sink"),tspan = if (!is.null(dat.fitting)) sort(unique(dat.fitting [["time"]])) else NULL,
df, dat.fitting = NULL) {
m1_0 = 0
names(x) <- names_x
y0 <- c(x ["parent_0"], m1_0)
names(y0) <- names_y
parameters<- x [c("k_parent_sink", "k_parent_m1", "k_m1_sink")]
stopifnot(!is.null(tspan))
out<- ode(y0, tspan, df, parameters)
if (is.null(dat.fitting)) {
rss<- out
}else {
rss<- sum(sapply(c("parent", "m1"), function(nm) {
o.time<- as.character(dat.fitting [dat.fitting$name == nm,"time"])
sum((out [, nm ][match(o.time, out [, "time"])] - dat.fitting [dat.fitting$name == nm, "value"])^2,na.rm = TRUE)
}))
}
return(rss)
}
res<- GenSA(fn = fn, lower = c(90, rep(0.001, 3)),
upper = c(110, rep(0.1, 3)),
control = list(max.time = 5), df = df,
dat.fitting = FOCUS_2006_D)
names(res$par) <- c("parent_0", "k_parent_sink", "k_parent_m1","k_m1_sink")
print(round(res$par, digits = 6))
#================================================#
df1<- function(t, y, parameters) {
d_parent<- 99.5984880305-parameters[1]*y["parent"]-0.050778*y ["parent"]
d_m1 <- parameters[3]*y["parent"]-parameters [2]* y ["m1"]
return(list(c(d_parent, d_m1)))
}
#================================================#
data<-as.data.frame(FOCUS_2006_D)
data1<-data[seq(1,22),]
plot<-ggplot(data = data,aes(x=time,y=value))+geom_point(aes(color=name))
library(ggplot2)
plot<-ggplot(data = data,aes(x=time,y=value))+geom_point(aes(color=name))
plot
data
Years <- seq(2012,2018,1)
init <- c(S_M=S_M0,S_W=S_W0,S_MSM=S_MSM0,I_M=I_M0,I_W=I_W0,I_MSM=I_MSM0,T_M=T_M0,T_W=T_W0,T_MSM=T_MSM0 )
parameter <- c(beta_1=0.004,beta_2=0.0247,beta_3=0.03674,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0,omega_2=0,kappa_1=0,kappa_2=0,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.77, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Men <-ode(init, Years, sex_oriented,parameter)[,5] +ode(init, Years, sex_oriented,parameter)[,7]+
ode(init, Years, sex_oriented,parameter)[,8]+ode(init, Years, sex_oriented,parameter)[10]
Women <-ode(init, Years, sex_oriented,parameter)[,6] +ode(init, Years, sex_oriented,parameter)[,9]
Men
Women
Men <-ode(init, Years, sex_oriented,parameter)[,5] +ode(init, Years, sex_oriented,parameter)[,7]+
ode(init, Years, sex_oriented,parameter)[,8]+ode(init, Years, sex_oriented,parameter)[,10]
Women <-ode(init, Years, sex_oriented,parameter)[,6] +ode(init, Years, sex_oriented,parameter)[,9]
Men
Women
Total_Men <-c(19084999,19142958,19192036,19263033,19305761,19230937,19183985)#,19303494) # 2012~2019 15-64
Total_Women <-c(18258526,18314400,18360874,18429691,18478656,18405536,18363056)#,18286058) # 2012~2019 15-64
Survival_Men <-c(6691,7436,8248,9010,9788,10489,11236)#,11938) # 2012~2019 생존감염자  15-64
Survival_Women <-c(552,593,624,658,690,716,742)#,764) # 2012~2019 생존감염자  15-64
Total_Men-Survival_Men
Survival_Women <-c(552,593,624,658,690,716,742)#,764) # 2012~2019 생존감염자  15-64
Total_Women-Survival_Women
data
Data <-as.data.frame(read_csv("~/GitHub/Data.csv"))
library(readr)
Data <-as.data.frame(read_csv("~/GitHub/Data.csv"))
Data
plot<-ggplot(data = Data,aes(x=Year,y=populatoin))+geom_point(aes(color=name))
plot
plot<-ggplot(data = Data,aes(x=Year,y=populatoin))+geom_point(aes(color=Name))
plot
plot<-ggplot(data = Data,aes(x=Year,y=population))+geom_point(aes(color=Name))
plot
Data1 <-Data[seq(1:14),]
Data1
plot<-ggplot(data = Data1,aes(x=Year,y=population))+geom_point(aes(color=Name))
plot
Data2 <-data[Seq(14:28),]
Data2 <-Data[Seq(14:28),]
plot<-ggplot(data = Data2,aes(x=Year,y=population))+geom_point(aes(color=Name))
Data2 <-Data[Seq(14:28),]
Data2 <-Data[seq(15:28),]
plot<-ggplot(data = Data2,aes(x=Year,y=population))+geom_point(aes(color=Name))
plot
Data
Data <-as.data.frame(read_csv("~/GitHub/Data.csv"))
Data1 <-Data[seq(1:14),]
plot<-ggplot(data = Data2,aes(x=Year,y=population))+geom_point(aes(color=Name))
plot
Data2 <-Data[seq(15:28),]
plot<-ggplot(data = Data2,aes(x=Year,y=population))+geom_point(aes(color=Name))
plot
Data2
Data
Data[seq(15:28),]
Data[seq(15:28),]
Data[15,]
Data[seq(15:28),]
Data[seq(15:27),]
c(15:28)
Data2 <- Data[c(15:28),]
Data2
plot<-ggplot(data = Data2,aes(x=Year,y=population))+geom_point(aes(color=Name))
plot
# PrEP = 50 , Edu = 50
Years <- seq(2018,2038,1)
init <- c(S_M=19079868,S_W=18361009,S_MSM=148919.7,I_M=180.2634,I_W=203.6377,I_MSM=4095.125,T_M=1253.061,T_W=538.3682,T_MSM=5707.558 )
parameter <- c(beta_1=0.004,beta_2=0.01765,beta_3=0.033786,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.39,omega_2=0.165,kappa_1=0.00758,kappa_2=0.43137,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.11, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Men <-ode(init, Years, sex_oriented,parameter)[,5] +ode(init, Years, sex_oriented,parameter)[,7]+
ode(init, Years, sex_oriented,parameter)[,8]+ode(init, Years, sex_oriented,parameter)[,10]
library(deSolve)
# PrEP = 50 , Edu = 50
Years <- seq(2018,2038,1)
init <- c(S_M=19079868,S_W=18361009,S_MSM=148919.7,I_M=180.2634,I_W=203.6377,I_MSM=4095.125,T_M=1253.061,T_W=538.3682,T_MSM=5707.558 )
parameter <- c(beta_1=0.004,beta_2=0.01765,beta_3=0.033786,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.39,omega_2=0.165,kappa_1=0.00758,kappa_2=0.43137,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.11, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
library(deSolve)
library(GenSA)
library(ggplot2)
library(readr)
sex_oriented <- function(year, state_values, parameters) {
with(as.list(c(state_values, parameters)),{
#Total population
# N_M = (S_M + I_M + T_M)
# N_W = (S_W + I_W + T_W)
# N_MSM= (S_MSM + I_MSM+T_MSM)
# transmission_rate
# lambda_M = beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M)
# lambda_W = beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W)
# lambda_MSM = beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM)
# Suceptible Population
dS_M = Pi * (1 - tau) * psi1 + rho * S_MSM - beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M) * S_M - ( mu_d * zeta ) * S_M
dS_W = Pi * tau * psi2 - beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W) * S_W - mu_d * S_W
dS_MSM = zeta * S_M -  beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM) * S_MSM - (mu_d * rho) * S_MSM
#Infected Population
dI_M = beta_1 * gamma_1 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_W + theta_1 * T_W) / (S_M + I_M + T_M)* S_M - (mu_d + delta_a) * I_M
dI_W = beta_2 * gamma_2 * ( 1 - omega_1 ) * ( 1- kappa_1 ) * (I_M + theta_2 * T_M)  / (S_W + I_W + T_W) * S_W - (mu_d + delta_a) * I_W
dI_MSM =  beta_3 * gamma_3 * ( 1 - omega_1 ) * ( 1 - omega_2) * ( 1- kappa_2 ) * (I_MSM + theta_3 * T_MSM)  / (S_MSM + I_MSM + T_MSM) * S_MSM - (mu_d + delta_a) * I_MSM
#Treated Populatoio but
dT_M = delta_a * I_M - (mu_d) * T_M
dT_W = delta_a * I_W - (mu_d) * T_W
dT_MSM = delta_a * I_MSM - (mu_d) * T_MSM
return(list(c(dS_M,dS_W,dS_MSM,dI_M,dI_W,dI_MSM,dT_M,dT_W,dT_MSM)))
})
}
# PrEP = 50 , Edu = 50
Years <- seq(2018,2038,1)
init <- c(S_M=19079868,S_W=18361009,S_MSM=148919.7,I_M=180.2634,I_W=203.6377,I_MSM=4095.125,T_M=1253.061,T_W=538.3682,T_MSM=5707.558 )
parameter <- c(beta_1=0.004,beta_2=0.01765,beta_3=0.033786,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.39,omega_2=0.165,kappa_1=0.00758,kappa_2=0.43137,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.11, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Men <-ode(init, Years, sex_oriented,parameter)[,5] +ode(init, Years, sex_oriented,parameter)[,7]+
ode(init, Years, sex_oriented,parameter)[,8]+ode(init, Years, sex_oriented,parameter)[,10]
Women <-ode(init, Years, sex_oriented,parameter)[,6] +ode(init, Years, sex_oriented,parameter)[,9]
Men
Women
# PrEP = 50 , Edu = 60
Years <- seq(2018,2038,1)
init <- c(S_M=19079868,S_W=18361009,S_MSM=148919.7,I_M=180.2634,I_W=203.6377,I_MSM=4095.125,T_M=1253.061,T_W=538.3682,T_MSM=5707.558 )
parameter <- c(beta_1=0.004,beta_2=0.01765,beta_3=0.033786,gamma_1=3,gamma_2=3,gamma_3=6,omega_1=0.468,omega_2=0.198,kappa_1=0.00758,kappa_2=0.43137,Pi = 19084999 + 18258526,tau=0.499246,
mu_d=0.00005825,zeta = 0.0000804, delta_a = 0.11, rho=0,psi1 = 0.0013,psi2 = 0.00098,theta_1=0.1,theta_2=0.3,theta_3 =0.3)
ode(init, Years, sex_oriented,parameter)
Men <-ode(init, Years, sex_oriented,parameter)[,5] +ode(init, Years, sex_oriented,parameter)[,7]+
ode(init, Years, sex_oriented,parameter)[,8]+ode(init, Years, sex_oriented,parameter)[,10]
Women <-ode(init, Years, sex_oriented,parameter)[,6] +ode(init, Years, sex_oriented,parameter)[,9]
